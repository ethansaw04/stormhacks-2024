{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n// **Github:** https://github.com/fidm/x509\n//\n// **License:** MIT\n/**\n * BufferVisitor is a visit tool to manipulate buffer.\n */\nclass BufferVisitor {\n  constructor(buf, start = 0, end = 0) {\n    this.start = start;\n    this.end = end > start ? end : start;\n    this.buf = buf;\n  }\n  /**\n   * return the underlying buffer length\n   */\n  get length() {\n    return this.buf.length;\n  }\n  /**\n   * Reset visitor' start and end value.\n   * @param start\n   * @param end\n   */\n  reset(start = 0, end = 0) {\n    this.start = start;\n    if (end >= this.start) {\n      this.end = end;\n    } else if (this.end < this.start) {\n      this.end = this.start;\n    }\n    return this;\n  }\n  /**\n   * consume some bytes.\n   * @param steps steps to walk\n   */\n  walk(steps) {\n    this.start = this.end;\n    this.end += steps;\n    return this;\n  }\n  /**\n   * The buffer should have remaining the \"steps\" of bytes to consume,\n   * otherwise it will throw an error with given message.\n   * @param steps steps to consume.\n   * @param message message to throw.\n   */\n  mustHas(steps, message = 'Too few bytes to parse.') {\n    const requested = this.end + steps;\n    if (requested > this.buf.length) {\n      const error = new Error(message);\n      error.available = this.buf.length;\n      error.requested = requested;\n      throw error;\n    }\n    this.walk(0);\n    return this;\n  }\n  /**\n   * Check the remaining bytes with bufferVisitor.mustHas method and then walk.\n   * @param steps steps to consume.\n   * @param message message to throw.\n   */\n  mustWalk(steps, message) {\n    this.mustHas(steps, message);\n    this.walk(steps);\n    return this;\n  }\n}\nexports.BufferVisitor = BufferVisitor;","map":{"version":3,"names":["BufferVisitor","constructor","buf","start","end","length","reset","walk","steps","mustHas","message","requested","error","Error","available","mustWalk","exports"],"sources":["../src/common.ts"],"sourcesContent":[null],"mappings":"AAAA,YAAY;;;;;AACZ;AACA;AACA;AAEA;;;AAGA,MAAaA,aAAa;EAIxBC,YAAaC,GAAW,EAAEC,KAAA,GAAgB,CAAC,EAAEC,GAAA,GAAc,CAAC;IAC1D,IAAI,CAACD,KAAK,GAAGA,KAAK;IAClB,IAAI,CAACC,GAAG,GAAGA,GAAG,GAAGD,KAAK,GAAGC,GAAG,GAAGD,KAAK;IACpC,IAAI,CAACD,GAAG,GAAGA,GAAG;EAChB;EAEA;;;EAGA,IAAIG,MAAMA,CAAA;IACR,OAAO,IAAI,CAACH,GAAG,CAACG,MAAM;EACxB;EAEA;;;;;EAKAC,KAAKA,CAAEH,KAAA,GAAgB,CAAC,EAAEC,GAAA,GAAc,CAAC;IACvC,IAAI,CAACD,KAAK,GAAGA,KAAK;IAClB,IAAIC,GAAG,IAAI,IAAI,CAACD,KAAK,EAAE;MACrB,IAAI,CAACC,GAAG,GAAGA,GAAG;KACf,MAAM,IAAI,IAAI,CAACA,GAAG,GAAG,IAAI,CAACD,KAAK,EAAE;MAChC,IAAI,CAACC,GAAG,GAAG,IAAI,CAACD,KAAK;;IAEvB,OAAO,IAAI;EACb;EAEA;;;;EAIAI,IAAIA,CAAEC,KAAa;IACjB,IAAI,CAACL,KAAK,GAAG,IAAI,CAACC,GAAG;IACrB,IAAI,CAACA,GAAG,IAAII,KAAK;IACjB,OAAO,IAAI;EACb;EAEA;;;;;;EAMAC,OAAOA,CAAED,KAAa,EAAEE,OAAA,GAAkB,yBAAyB;IACjE,MAAMC,SAAS,GAAG,IAAI,CAACP,GAAG,GAAGI,KAAK;IAClC,IAAIG,SAAS,GAAG,IAAI,CAACT,GAAG,CAACG,MAAM,EAAE;MAC/B,MAAMO,KAAK,GAAG,IAAIC,KAAK,CAACH,OAAO,CAAQ;MACvCE,KAAK,CAACE,SAAS,GAAG,IAAI,CAACZ,GAAG,CAACG,MAAM;MACjCO,KAAK,CAACD,SAAS,GAAGA,SAAS;MAC3B,MAAMC,KAAK;;IAEb,IAAI,CAACL,IAAI,CAAC,CAAC,CAAC;IACZ,OAAO,IAAI;EACb;EAEA;;;;;EAKAQ,QAAQA,CAAEP,KAAa,EAAEE,OAAgB;IACvC,IAAI,CAACD,OAAO,CAACD,KAAK,EAAEE,OAAO,CAAC;IAC5B,IAAI,CAACH,IAAI,CAACC,KAAK,CAAC;IAChB,OAAO,IAAI;EACb;;AArEFQ,OAAA,CAAAhB,aAAA,GAAAA,aAAA","ignoreList":[]},"metadata":{},"sourceType":"script"}