{"ast":null,"code":"'use strict';\n\nconst {\n  validSlog,\n  validKodaNamena,\n  validLength,\n  validIBAN,\n  required,\n  formatAmount,\n  formatBool,\n  formatDate,\n  parseAmount,\n  parseBool,\n  parseDate\n} = require('./util');\nclass UPNQRError extends Error {\n  constructor(msg) {\n    super();\n    this.name = 'UPNQRError';\n    this.message = msg;\n  }\n}\nconst items = [{\n  name: 'slog',\n  filterIn: [validSlog]\n}, {\n  name: 'IBAN_placnika',\n  filterIn: [validIBAN]\n}, {\n  name: 'polog',\n  filterIn: [parseBool],\n  filterOut: [formatBool]\n}, {\n  name: 'dvig',\n  filterIn: [parseBool],\n  filterOut: [formatBool]\n}, {\n  name: 'referenca_placnika',\n  filterIn: [validLength(26)]\n}, {\n  name: 'ime_placnika',\n  filterIn: [validLength(33)]\n}, {\n  name: 'ulica_placnika',\n  filterIn: [validLength(33)]\n}, {\n  name: 'kraj_placnika',\n  filterIn: [validLength(33)]\n}, {\n  name: 'znesek',\n  filterIn: [required, validLength(11), parseAmount],\n  filterOut: [formatAmount]\n}, {\n  name: 'datum_placila',\n  filterIn: [parseDate]\n}, {\n  name: 'nujno',\n  filterIn: [parseBool],\n  filterOut: [formatBool]\n}, {\n  name: 'koda_namena',\n  filterIn: [validKodaNamena]\n}, {\n  name: 'namen_placila'\n}, {\n  name: 'rok_placila',\n  filterIn: [parseDate],\n  filterOut: [formatDate]\n}, {\n  name: 'IBAN_prejemnika',\n  filterIn: [required, validIBAN]\n}, {\n  name: 'referenca_prejemnika'\n}, {\n  name: 'ime_prejemnika'\n}, {\n  name: 'ulica_prejemnika'\n}, {\n  name: 'kraj_prejemnika'\n}, {\n  name: 'vsota',\n  filterIn: [required, parseFloat]\n}, {\n  name: 'rezerva'\n}];\nfunction encode(upn) {\n  if (!('slog' in upn)) upn.slog = 'UPNQR';\n  let sum = 0;\n  return items.map((item, i) => {\n    const val = applyFilters(upn[item.name] || '', item && item.filterOut, item.name);\n    if (i < 19) sum += val.length;else if (item.name === 'vsota') return sum + 19;\n    return val;\n  }).join('\\n');\n}\nfunction decode(code) {\n  if (code.length > 411) throw new UPNQRError('Code is too long');\n  let sum = 0;\n  const upn = code.split('\\n').reduce((agg, val, i) => {\n    const item = items[i];\n    if (i < 19) sum += val.length + 1;\n    val = applyFilters(val, item && item.filterIn, item.name);\n    if (val !== '') agg[item.name] = val;\n    return agg;\n  }, {});\n  if (sum !== upn.vsota) throw new UPNQRError(`Invalid checksum. Expected ${upn.vsota}, got ${sum}`);\n  return upn;\n}\nfunction applyFilters(val, filters, name) {\n  if (filters) val = filters.reduce((v, filter) => filter(v, name), val);\n  return val;\n}\nmodule.exports = {\n  encode,\n  decode,\n  UPNQRError\n};","map":{"version":3,"names":["validSlog","validKodaNamena","validLength","validIBAN","required","formatAmount","formatBool","formatDate","parseAmount","parseBool","parseDate","require","UPNQRError","Error","constructor","msg","name","message","items","filterIn","filterOut","parseFloat","encode","upn","slog","sum","map","item","i","val","applyFilters","length","join","decode","code","split","reduce","agg","vsota","filters","v","filter","module","exports"],"sources":["/Users/jakechoi/Documents/StormhacksFall2024/stormhacks-2024/scanecipe/node_modules/upnqr/lib/upnqr.js"],"sourcesContent":["'use strict'\n\nconst {\n  validSlog, validKodaNamena, validLength, validIBAN, required,\n  formatAmount, formatBool, formatDate, parseAmount, parseBool, parseDate\n} = require('./util')\n\nclass UPNQRError extends Error {\n  constructor (msg) {\n    super()\n    this.name = 'UPNQRError'\n    this.message = msg\n  }\n}\n\nconst items = [\n  { name: 'slog', filterIn: [validSlog] },\n  { name: 'IBAN_placnika', filterIn: [validIBAN] },\n  { name: 'polog', filterIn: [parseBool], filterOut: [formatBool] },\n  { name: 'dvig', filterIn: [parseBool], filterOut: [formatBool] },\n  { name: 'referenca_placnika', filterIn: [validLength(26)] },\n  { name: 'ime_placnika', filterIn: [validLength(33)] },\n  { name: 'ulica_placnika', filterIn: [validLength(33)] },\n  { name: 'kraj_placnika', filterIn: [validLength(33)] },\n  { name: 'znesek', filterIn: [required, validLength(11), parseAmount], filterOut: [formatAmount] },\n  { name: 'datum_placila', filterIn: [parseDate] },\n  { name: 'nujno', filterIn: [parseBool], filterOut: [formatBool] },\n  { name: 'koda_namena', filterIn: [validKodaNamena] },\n  { name: 'namen_placila' },\n  { name: 'rok_placila', filterIn: [parseDate], filterOut: [formatDate] },\n  { name: 'IBAN_prejemnika', filterIn: [required, validIBAN] },\n  { name: 'referenca_prejemnika' },\n  { name: 'ime_prejemnika' },\n  { name: 'ulica_prejemnika' },\n  { name: 'kraj_prejemnika' },\n  { name: 'vsota', filterIn: [required, parseFloat] },\n  { name: 'rezerva' }\n]\n\nfunction encode (upn) {\n  if (!('slog' in upn)) upn.slog = 'UPNQR'\n  let sum = 0\n  return items.map((item, i) => {\n    const val = applyFilters(upn[item.name] || '', item && item.filterOut, item.name)\n    if (i < 19) sum += val.length\n    else if (item.name === 'vsota') return sum + 19\n    return val\n  }).join('\\n')\n}\n\nfunction decode (code) {\n  if (code.length > 411) throw new UPNQRError('Code is too long')\n  let sum = 0\n  const upn = code.split('\\n').reduce((agg, val, i) => {\n    const item = items[i]\n    if (i < 19) sum += val.length + 1\n    val = applyFilters(val, item && item.filterIn, item.name)\n    if (val !== '') agg[item.name] = val\n    return agg\n  }, {})\n  if (sum !== upn.vsota) throw new UPNQRError(`Invalid checksum. Expected ${upn.vsota}, got ${sum}`)\n  return upn\n}\n\nfunction applyFilters (val, filters, name) {\n  if (filters) val = filters.reduce((v, filter) => filter(v, name), val)\n  return val\n}\n\nmodule.exports = {\n  encode, decode, UPNQRError\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}